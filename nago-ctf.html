<!DOCTYPE html>
<html lang="ja">
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5ZM4DTR');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <title>nago-ctf</title>
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5ZM4DTR"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div style="text-align: center">
      <h1>志摩リン in 志摩リン</h1>
      <img alt="003.png" src="assets/img/posts/003.png">
      <p><a href="assets/img/posts/003.png" download="003.png">DOWNLOAD</a></p>
      <p>
        <b>Flag is nago-ctf{</b>
        <input id="flag" type="text" name="flag" size="40" maxlength="35" placeholder="Please enter flag" />
        <b>}</b>
      </p>
      <button id="submit-flag" type="submit" onclick="submit()">SUBMIT</button>
    </div>
    <script>
      async function submit() {
        // Flag is hidden in the image:)
        const flag = "f958fd45a35278e0f632cfc19f16f2daff8772ede48e8e829607e5e4f7bfeffd";
        const input = document.getElementById("flag").value;
        const hashinput = await hash(input);
        if (hashinput === flag) {
          alert("Congratulations, you are correct!")
        } else {
          alert("Incorrect")
        }
      }
      async function hash(string) {
        const utf8 = new TextEncoder().encode(string);
        const hashBuffer = await crypto.subtle.digest('SHA-256', utf8);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray
          .map((bytes) => bytes.toString(16).padStart(2, '0'))
          .join('');
        return hashHex;
      }
    </script>
  </body>
</html>